<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>스마트 평균 계산기 - 어떤 형식이든 자동 인식</title>
    <meta name="description" content="텍스트에서 숫자를 자동으로 추출해서 평균을 계산하는 스마트 계산기. CSV, 엑셀 데이터, 한글 단위까지 모두 인식합니다.">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Malgun Gothic', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            overflow: hidden;
            animation: slideUp 0.6s ease-out;
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: pulse 4s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }
        
        .content {
            padding: 40px 30px;
        }
        
        .input-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }
        
        .input-section:hover {
            border-color: #667eea;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.1);
        }
        
        .input-label {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .input-label .icon {
            font-size: 1.5rem;
        }
        
        #dataInput {
            width: 100%;
            min-height: 200px;
            padding: 20px;
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            font-size: 16px;
            font-family: 'Consolas', 'Monaco', monospace;
            resize: vertical;
            transition: all 0.3s ease;
            background: white;
            line-height: 1.6;
        }
        
        #dataInput:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .examples {
            background: linear-gradient(135deg, #fff3e0 0%, #ffeaa7 100%);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid #f39c12;
        }
        
        .examples h4 {
            color: #d68910;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }
        
        .examples-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .example-item {
            background: rgba(255,255,255,0.7);
            padding: 10px;
            border-radius: 8px;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .example-title {
            font-weight: bold;
            color: #d68910;
            margin-bottom: 5px;
        }
        
        .controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
            margin: 25px 0;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #fd79a8 0%, #e84393 100%);
        }
        
        .parsing-preview {
            background: #e3f2fd;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid #2196f3;
            display: none;
        }
        
        .parsing-title {
            font-weight: bold;
            color: #1976d2;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        .found-numbers {
            background: white;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            line-height: 1.5;
            border: 1px solid #bbdefb;
            max-height: 150px;
            overflow-y: auto;
        }
        
        .result-section {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
            border: 2px solid #28a745;
            display: none;
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .result-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #155724;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .result-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .stat-item {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #28a745;
        }
        
        .average-highlight {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            margin-top: 20px;
            box-shadow: 0 5px 20px rgba(40, 167, 69, 0.3);
        }
        
        .average-label {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 5px;
        }
        
        .average-value {
            font-size: 2.5rem;
            font-weight: bold;
        }
        
        .features {
            margin-top: 40px;
            text-align: center;
        }
        
        .features h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .feature-item {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .feature-item:hover {
            transform: translateY(-5px);
        }
        
        .feature-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }
        
        .feature-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }
        
        .feature-desc {
            color: #666;
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            
            .header {
                padding: 30px 20px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .content {
                padding: 30px 20px;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>📊 스마트 평균 계산기</h1>
            <p>어떤 형식으로 입력해도 자동으로 숫자를 찾아서 평균을 계산합니다</p>
        </div>
        
        <div class="content">
            <div class="input-section">
                <div class="input-label">
                    <span class="icon">📝</span>
                    데이터 입력 (자유 형식)
                </div>
                
                <textarea id="dataInput" placeholder="여기에 숫자가 포함된 텍스트를 자유롭게 입력하세요...

예시:
상품A: 1,250원, 상품B: 2,800원, 상품C: 950원
점수: 85점 90점 78점 92점 88점
가격	수량	합계
1200	5	6000
800	3	2400
1500	2	3000

또는 CSV 데이터를 붙여넣으세요:
김철수,85,90,78
이영희,92,88,85
박민수,79,84,91

* 쉼표, 공백, 탭, 줄바꿈 등 어떤 구분자든 자동 인식
* 한글 단위(천, 만, 억)도 자동 변환
* 소수점 자리수는 입력 데이터에 맞춰 자동 조정"></textarea>

                <div class="examples">
                    <h4>💡 다양한 입력 예시</h4>
                    <div class="examples-grid">
                        <div class="example-item">
                            <div class="example-title">CSV/엑셀 데이터</div>
                            김철수,85,90,78<br>
                            이영희,92,88,85
                        </div>
                        <div class="example-item">
                            <div class="example-title">가격 정보</div>
                            상품A: 1,250원<br>
                            상품B: 2천원<br>
                            상품C: 1만5천원
                        </div>
                        <div class="example-item">
                            <div class="example-title">성적 데이터</div>
                            수학: 85점<br>
                            영어: 90점<br>
                            과학: 78점
                        </div>
                        <div class="example-item">
                            <div class="example-title">측정값</div>
                            키: 175.5cm<br>
                            몸무게: 70.2kg<br>
                            체지방: 15.8%
                        </div>
                    </div>
                </div>
            </div>

            <div class="parsing-preview" id="parsingPreview">
                <div class="parsing-title">🔍 인식된 숫자들</div>
                <div class="found-numbers" id="foundNumbers"></div>
            </div>

            <div class="controls">
                <button class="btn" onclick="calculateAverage()">
                    📊 평균 계산하기
                </button>
                <button class="btn btn-secondary" onclick="showParsingPreview()">
                    🔍 숫자 인식 미리보기
                </button>
                <button class="btn btn-danger" onclick="clearAll()">
                    🗑️ 초기화
                </button>
            </div>

            <div class="result-section" id="resultSection">
                <div class="result-title">📈 계산 결과</div>
                <div class="result-stats" id="resultStats"></div>
                <div class="average-highlight">
                    <div class="average-label">평균값</div>
                    <div class="average-value" id="averageValue">0</div>
                </div>
            </div>

            <div class="features">
                <h3>🌟 스마트 계산기의 특별한 기능</h3>
                <div class="features-grid">
                    <div class="feature-item">
                        <div class="feature-icon">🧠</div>
                        <div class="feature-title">지능형 숫자 인식</div>
                        <div class="feature-desc">한글 단위(천, 만, 억), 쉼표, 소수점 등 어떤 형식이든 자동 인식</div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">📋</div>
                        <div class="feature-title">CSV/엑셀 데이터 지원</div>
                        <div class="feature-desc">스프레드시트에서 복사한 데이터를 바로 붙여넣기 가능</div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">🎯</div>
                        <div class="feature-title">정밀도 자동 조정</div>
                        <div class="feature-desc">입력 데이터의 최대 소수점 자리수에 맞춰 결과 표시</div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">📱</div>
                        <div class="feature-title">모바일 최적화</div>
                        <div class="feature-desc">스마트폰, 태블릿에서도 완벽하게 작동</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        class SmartNumberParser {
            constructor() {
                // 한글 숫자 단위 매핑
                this.koreanUnits = {
                    '천': 1000,
                    '만': 10000,
                    '억': 100000000,
                    '조': 1000000000000
                };
            }

            // 텍스트에서 모든 숫자 추출
            extractNumbers(text) {
                if (!text || typeof text !== 'string') return { numbers: [], maxDecimals: 0 };

                const numbers = [];
                let maxDecimals = 0;

                // 1. 한글 단위가 포함된 숫자 처리
                const koreanMatches = this.extractKoreanNumbers(text);
                numbers.push(...koreanMatches.numbers);
                maxDecimals = Math.max(maxDecimals, koreanMatches.maxDecimals);

                // 2. 일반 숫자 패턴 (쉼표, 소수점 포함)
                let remainingText = text;
                
                // 한글 단위 숫자는 제거해서 중복 방지
                for (let unit of Object.keys(this.koreanUnits)) {
                    remainingText = remainingText.replace(new RegExp(`\\d+(?:\\.\\d+)?\\s*${unit}`, 'g'), '');
                }

                const numberPattern = /\d{1,3}(?:,\d{3})*(?:\.\d+)?|\d+(?:\.\d+)?/g;
                const matches = remainingText.match(numberPattern) || [];

                for (let match of matches) {
                    const cleanNumber = match.replace(/,/g, '');
                    const num = parseFloat(cleanNumber);
                    
                    if (!isNaN(num) && num !== 0) {
                        numbers.push(num);
                        
                        // 소수점 자리수 계산
                        if (cleanNumber.includes('.')) {
                            const decimals = cleanNumber.split('.')[1].length;
                            maxDecimals = Math.max(maxDecimals, decimals);
                        }
                    }
                }

                return { numbers, maxDecimals };
            }

            // 한글 단위 숫자 추출
            extractKoreanNumbers(text) {
                const numbers = [];
                let maxDecimals = 0;

                for (let [unit, multiplier] of Object.entries(this.koreanUnits)) {
                    // 숫자 + 한글단위 패턴 매칭
                    const pattern = new RegExp(`(\\d+(?:\\.\\d+)?)\\s*${unit}`, 'g');
                    let match;

                    while ((match = pattern.exec(text)) !== null) {
                        const baseNumber = parseFloat(match[1]);
                        if (!isNaN(baseNumber)) {
                            const result = baseNumber * multiplier;
                            numbers.push(result);

                            // 소수점 자리수 계산
                            if (match[1].includes('.')) {
                                const decimals = match[1].split('.')[1].length;
                                maxDecimals = Math.max(maxDecimals, decimals);
                            }
                        }
                    }
                }

                return { numbers, maxDecimals };
            }

            // 평균 계산
            calculateAverage(numbers) {
                if (!Array.isArray(numbers) || numbers.length === 0) {
                    return null;
                }

                const sum = numbers.reduce((acc, num) => acc + num, 0);
                return sum / numbers.length;
            }

            // 통계 계산
            calculateStats(numbers) {
                if (!Array.isArray(numbers) || numbers.length === 0) {
                    return null;
                }

                const sorted = [...numbers].sort((a, b) => a - b);
                const sum = numbers.reduce((acc, num) => acc + num, 0);
                const avg = sum / numbers.length;

                // 중앙값 계산
                let median;
                const mid = Math.floor(sorted.length / 2);
                if (sorted.length % 2 === 0) {
                    median = (sorted[mid - 1] + sorted[mid]) / 2;
                } else {
                    median = sorted[mid];
                }

                // 표준편차 계산
                const variance = numbers.reduce((acc, num) => acc + Math.pow(num - avg, 2), 0) / numbers.length;
                const stdDev = Math.sqrt(variance);

                return {
                    count: numbers.length,
                    sum: sum,
                    average: avg,
                    median: median,
                    min: Math.min(...numbers),
                    max: Math.max(...numbers),
                    range: Math.max(...numbers) - Math.min(...numbers),
                    standardDeviation: stdDev
                };
            }
        }

        // 전역 파서 인스턴스
        const parser = new SmartNumberParser();

        // 숫자 인식 미리보기
        function showParsingPreview() {
            const text = document.getElementById('dataInput').value;
            const { numbers, maxDecimals } = parser.extractNumbers(text);
            
            const preview = document.getElementById('parsingPreview');
            const foundNumbers = document.getElementById('foundNumbers');
            
            if (numbers.length === 0) {
                foundNumbers.innerHTML = '<span style="color: #dc3545;">숫자를 찾을 수 없습니다. 데이터를 입력해주세요.</span>';
            } else {
                const numbersDisplay = numbers.map((num, index) => 
                    `${index + 1}. ${num.toLocaleString('ko-KR', {
                        minimumFractionDigits: maxDecimals,
                        maximumFractionDigits: maxDecimals
                    })}`
                ).join('\n');
                
                foundNumbers.innerHTML = `
                    <strong>찾은 숫자 개수:</strong> ${numbers.length}개<br>
                    <strong>최대 소수점 자리:</strong> ${maxDecimals}자리<br><br>
                    <strong>인식된 숫자들:</strong><br>
                    ${numbersDisplay.replace(/\n/g, '<br>')}
                `;
            }
            
            preview.style.display = 'block';
            preview.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // 평균 계산
        function calculateAverage() {
            const text = document.getElementById('dataInput').value;
            
            if (!text.trim()) {
                alert('데이터를 입력해주세요.');
                return;
            }

            const { numbers, maxDecimals } = parser.extractNumbers(text);
            
            if (numbers.length === 0) {
                alert('입력된 텍스트에서 숫자를 찾을 수 없습니다.\n\n예시:\n- 85, 90, 78, 92\n- 상품A: 1,250원\n- 점수: 85점');
                return;
            }

            const stats = parser.calculateStats(numbers);
            
            // 결과 표시
            displayResults(stats, maxDecimals);
            
            // 미리보기도 함께 표시
            showParsingPreview();
        }

        // 결과 표시
        function displayResults(stats, maxDecimals) {
            const resultSection = document.getElementById('resultSection');
            const resultStats = document.getElementById('resultStats');
            const averageValue = document.getElementById('averageValue');

            // 소수점 자리수 결정 (최소 1자리, 최대 입력 데이터의 최대 자리수)
            const displayDecimals = Math.max(1, maxDecimals);

            // 통계 정보 표시
            resultStats.innerHTML = `
                <div class="stat-item">
                    <div class="stat-label">데이터 개수</div>
                    <div class="stat-value">${stats.count.toLocaleString()}개</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">합계</div>
                    <div class="stat-value">${stats.sum.toLocaleString('ko-KR', {
                        minimumFractionDigits: displayDecimals,
                        maximumFractionDigits: displayDecimals
                    })}</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">최솟값</div>
                    <div class="stat-value">${stats.min.toLocaleString('ko-KR', {
                        minimumFractionDigits: displayDecimals,
                        maximumFractionDigits: displayDecimals
                    })}</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">최댓값</div>
                    <div class="stat-value">${stats.max.toLocaleString('ko-KR', {
                        minimumFractionDigits: displayDecimals,
                        maximumFractionDigits: displayDecimals
                    })}</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">중앙값</div>
                    <div class="stat-value">${stats.median.toLocaleString('ko-KR', {
                        minimumFractionDigits: displayDecimals,
                        maximumFractionDigits: displayDecimals
                    })}</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">표준편차</div>
                    <div class="stat-value">${stats.standardDeviation.toLocaleString('ko-KR', {
                        minimumFractionDigits: displayDecimals,
                        maximumFractionDigits: displayDecimals
                    })}</div>
                </div>
            `;

            // 평균값 표시
            averageValue.textContent = stats.average.toLocaleString('ko-KR', {
                minimumFractionDigits: displayDecimals,
                maximumFractionDigits: displayDecimals
            });

            resultSection.style.display = 'block';
            resultSection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // 초기화
        function clearAll() {
            document.getElementById('dataInput').value = '';
            document.getElementById('resultSection').style.display = 'none';
            document.getElementById('parsingPreview').style.display = 'none';
            document.getElementById('dataInput').focus();
        }

        // 페이지 로드 시 예시 데이터
        window.addEventListener('load', function() {
            const exampleData = `0.2869 0.2819 0.2809 0.2822 0.2825 0.2827 0.2828 0.2836 0.2824 0.2818 0.2823 0.2816 0.2826 0.2822 0.2823 0.2821 0.282 0.2814 0.2826 0.2815 0.2772 0.2762 0.277 0.2799 0.2781 0.2761 0.2744 0.273 0.2726 0.2745 0.2751 0.2743 0.2736 0.2733 0.2742 0.2807 0.2809 0.281 0.2818 0.2816 0.2798 0.2819 0.2859 0.2821 0.2806 0.2824 0.2829 0.2819 0.2734 0.2724 0.2735 0.2726 0.2745 0.2764 0.2729 0.2725 0.2745 0.2737 0.2722 0.2728 0.2738 0.2754 0.2746 0.2753 0.2766 0.275 0.2748 0.277 0.2757 0.2773 0.2827 0.2823 0.2821 0.2814 0.2811 0.2815 0.2807 0.2827 0.2765 0.2733 0.2764 0.2765 0.2752 0.2786 0.2753 0.2762 0.2778 0.2831 0.2815 0.2808 0.2807 0.2821 0.2835 0.2835 0.283 0.2823 0.2824 0.2817`;

            document.getElementById('dataInput').value = exampleData;
            
            // 2초 후 자동 계산 (사용자가 기능을 이해할 수 있도록)
            setTimeout(() => {
                if (document.getElementById('dataInput').value === exampleData) {
                    calculateAverage();
                }
            }, 2000);
        });

        // 엔터키 이벤트 (Ctrl+Enter로 계산)
        document.getElementById('dataInput').addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                calculateAverage();
            }
        });

        // 실시간 입력 감지 (옵션)
        let inputTimeout;
        document.getElementById('dataInput').addEventListener('input', function() {
            clearTimeout(inputTimeout);
            inputTimeout = setTimeout(() => {
                const text = this.value;
                if (text.length > 10) { // 최소한의 데이터가 있을 때만
                    const { numbers } = parser.extractNumbers(text);
                    if (numbers.length > 0) {
                        // 입력란 테두리 색상으로 피드백
                        this.style.borderColor = '#28a745';
                    } else {
                        this.style.borderColor = '#e1e5e9';
                    }
                }
            }, 500);
        });
    </script>
</body>
</html>
