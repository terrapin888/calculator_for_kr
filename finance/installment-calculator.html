<!DOCTYPE html>
<html lang="ko">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>할부 계산기 - 할부금 자동 계산 | 스마트 파싱</title>
   <meta name="description" content="할부 계산기로 할부금과 총 이자를 쉽게 계산하세요. 원금, 금리, 기간을 입력하면 자동으로 월 할부금을 계산합니다.">
   <style>
       * {
           margin: 0;
           padding: 0;
           box-sizing: border-box;
       }
       
       body {
           font-family: 'Malgun Gothic', -apple-system, BlinkMacSystemFont, sans-serif;
           background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
           min-height: 100vh;
           padding: 20px;
       }
       
       .container {
           max-width: 1200px;
           margin: 0 auto;
           background: white;
           border-radius: 20px;
           box-shadow: 0 25px 50px rgba(0,0,0,0.15);
           overflow: hidden;
           animation: slideUp 0.6s ease-out;
       }
       
       @keyframes slideUp {
           from { opacity: 0; transform: translateY(30px); }
           to { opacity: 1; transform: translateY(0); }
       }
       
       .header {
           background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
           color: white;
           padding: 40px 30px;
           text-align: center;
           position: relative;
           overflow: hidden;
       }
       
       .header::before {
           content: '';
           position: absolute;
           top: -50%;
           left: -50%;
           width: 200%;
           height: 200%;
           background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
           animation: pulse 4s ease-in-out infinite;
       }
       
       @keyframes pulse {
           0%, 100% { transform: scale(1); }
           50% { transform: scale(1.1); }
       }
       
       .header h1 {
           font-size: 2.5rem;
           margin-bottom: 10px;
           position: relative;
           z-index: 1;
       }
       
       .header p {
           font-size: 1.1rem;
           opacity: 0.9;
           position: relative;
           z-index: 1;
       }
       
       .content {
           padding: 40px 30px;
       }
       
       .calculator-tabs {
           display: flex;
           background: #f8f9fa;
           border-radius: 15px;
           padding: 5px;
           margin-bottom: 30px;
           gap: 5px;
       }
       
       .tab-button {
           flex: 1;
           padding: 15px 20px;
           border: none;
           border-radius: 10px;
           background: transparent;
           cursor: pointer;
           transition: all 0.3s ease;
           font-weight: 600;
           font-size: 14px;
       }
       
       .tab-button.active {
           background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
           color: white;
       }
       
       .tab-content {
           display: none;
       }
       
       .tab-content.active {
           display: block;
       }
       
       .input-section {
           background: #f8f9fa;
           border-radius: 15px;
           padding: 30px;
           margin-bottom: 30px;
           border: 2px solid #e9ecef;
       }
       
       .input-grid {
           display: grid;
           grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
           gap: 25px;
       }
       
       .input-group {
           background: white;
           border-radius: 12px;
           padding: 20px;
           box-shadow: 0 2px 10px rgba(0,0,0,0.05);
       }
       
       .input-label {
           font-size: 1.1rem;
           font-weight: 600;
           color: #333;
           margin-bottom: 10px;
           display: flex;
           align-items: center;
           gap: 8px;
       }
       
       input[type="text"], input[type="number"], select {
           width: 100%;
           padding: 15px;
           border: 2px solid #e1e5e9;
           border-radius: 8px;
           font-size: 16px;
           transition: all 0.3s ease;
           background: #fafbfc;
       }
       
       input:focus, select:focus {
           outline: none;
           border-color: #ff9a9e;
           background: white;
           box-shadow: 0 0 0 3px rgba(255, 154, 158, 0.1);
       }
       
       .parsed-result {
           margin-top: 10px;
           padding: 10px;
           background: #fff3e0;
           border-radius: 6px;
           font-size: 14px;
           color: #ef6c00;
       }
       
       .controls {
           display: flex;
           gap: 15px;
           flex-wrap: wrap;
           justify-content: center;
           margin: 25px 0;
       }
       
       .btn {
           background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
           color: white;
           border: none;
           padding: 15px 30px;
           border-radius: 25px;
           font-size: 16px;
           font-weight: 600;
           cursor: pointer;
           transition: all 0.3s ease;
       }
       
       .btn:hover {
           transform: translateY(-2px);
           box-shadow: 0 8px 25px rgba(255, 154, 158, 0.3);
       }
       
       .btn-secondary {
           background: linear-gradient(135deg, #4fc3f7 0%, #29b6f6 100%);
       }
       
       .btn-danger {
           background: linear-gradient(135deg, #ef5350 0%, #f44336 100%);
       }
       
       .result-section {
           background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c9 100%);
           border-radius: 15px;
           padding: 30px;
           margin-top: 30px;
           border: 2px solid #4caf50;
           display: none;
           animation: fadeIn 0.5s ease-in;
       }
       
       @keyframes fadeIn {
           from { opacity: 0; transform: translateY(20px); }
           to { opacity: 1; transform: translateY(0); }
       }
       
       .result-title {
           font-size: 1.5rem;
           font-weight: bold;
           color: #2e7d32;
           margin-bottom: 25px;
           text-align: center;
       }
       
       .installment-display {
           background: white;
           border-radius: 15px;
           padding: 30px;
           text-align: center;
           margin-bottom: 25px;
           box-shadow: 0 5px 20px rgba(0,0,0,0.1);
       }
       
       .installment-value {
           font-size: 3rem;
           font-weight: bold;
           color: #4caf50;
           margin-bottom: 10px;
           font-family: 'Courier New', monospace;
       }
       
       .installment-description {
           font-size: 1.2rem;
           color: #666;
       }
       
       .result-grid {
           display: grid;
           grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
           gap: 20px;
       }
       
       .result-item {
           background: white;
           padding: 20px;
           border-radius: 12px;
           text-align: center;
           box-shadow: 0 3px 15px rgba(0,0,0,0.1);
       }
       
       .result-label {
           font-size: 0.9rem;
           color: #666;
           margin-bottom: 8px;
       }
       
       .result-value {
           font-size: 1.3rem;
           font-weight: bold;
           color: #4caf50;
       }
       
       .payment-schedule {
           background: white;
           border-radius: 12px;
           padding: 20px;
           margin-top: 20px;
           box-shadow: 0 3px 15px rgba(0,0,0,0.1);
           max-height: 400px;
           overflow-y: auto;
       }
       
       .schedule-title {
           font-size: 1.1rem;
           font-weight: bold;
           color: #333;
           margin-bottom: 15px;
           text-align: center;
       }
       
       .schedule-table {
           width: 100%;
           border-collapse: collapse;
           font-size: 14px;
       }
       
       .schedule-table th, .schedule-table td {
           padding: 8px 12px;
           text-align: center;
           border-bottom: 1px solid #e9ecef;
       }
       
       .schedule-table th {
           background: #f8f9fa;
           font-weight: bold;
           color: #333;
           position: sticky;
           top: 0;
       }
       
       .preset-amounts {
           background: white;
           border-radius: 12px;
           padding: 20px;
           margin-top: 20px;
           box-shadow: 0 3px 15px rgba(0,0,0,0.1);
       }
       
       .preset-title {
           font-size: 1.1rem;
           font-weight: bold;
           color: #333;
           margin-bottom: 15px;
           text-align: center;
       }
       
       .preset-grid {
           display: grid;
           grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
           gap: 10px;
       }
       
       .preset-btn {
           padding: 12px 15px;
           border: 2px solid #e9ecef;
           border-radius: 20px;
           background: white;
           cursor: pointer;
           transition: all 0.3s ease;
           text-align: center;
           font-weight: 600;
           font-size: 13px;
       }
       
       .preset-btn:hover {
           border-color: #ff9a9e;
           background: rgba(255, 154, 158, 0.1);
       }
       
       @media (max-width: 768px) {
           .container {
               margin: 10px;
           }
           
           .header h1 {
               font-size: 2rem;
           }
           
           .calculator-tabs {
               flex-direction: column;
           }
           
           .input-grid {
               grid-template-columns: 1fr;
           }
           
           .controls {
               flex-direction: column;
           }
           
           .btn {
               width: 100%;
           }
           
           .installment-value {
               font-size: 2.5rem;
           }
           
           .schedule-table {
               font-size: 12px;
           }
       }
   </style>
</head>
<body>
   <div class="container">
       <div class="header">
           <h1>💳 할부 계산기</h1>
           <p>할부금과 이자를 쉽게 계산하고 상환 계획을 세우세요</p>
       </div>
       
       <div class="content">
           <div class="calculator-tabs">
               <button class="tab-button active" onclick="switchTab('basic')">기본 할부</button>
               <button class="tab-button" onclick="switchTab('loan')">대출 계산</button>
               <button class="tab-button" onclick="switchTab('early')">중도상환</button>
           </div>
           
           <!-- 기본 할부 -->
           <div id="basic" class="tab-content active">
               <div class="input-section">
                   <div class="input-grid">
                       <div class="input-group">
                           <div class="input-label">
                               <span>💰</span>
                               원금 (구매 금액)
                           </div>
                           <input type="text" id="principal-amount" placeholder="예: 1000만원, 10000000원..." oninput="smartParseBasic()">
                           <div class="parsed-result" id="principalAmountParsed">금액을 입력해주세요</div>
                       </div>
                       
                       <div class="input-group">
                           <div class="input-label">
                               <span>📊</span>
                               연이율 (%)
                           </div>
                           <input type="number" id="interest-rate" placeholder="예: 5.5" step="0.1" oninput="smartParseBasic()">
                           <div class="parsed-result" id="interestRateParsed">이율을 입력해주세요</div>
                       </div>
                       
                       <div class="input-group">
                           <div class="input-label">
                               <span>📅</span>
                               할부 기간
                           </div>
                           <select id="installment-period" onchange="smartParseBasic()">
                               <option value="">기간 선택</option>
                               <option value="6">6개월</option>
                               <option value="12">12개월 (1년)</option>
                               <option value="18">18개월</option>
                               <option value="24">24개월 (2년)</option>
                               <option value="36">36개월 (3년)</option>
                               <option value="48">48개월 (4년)</option>
                               <option value="60">60개월 (5년)</option>
                               <option value="72">72개월 (6년)</option>
                           </select>
                           <div class="parsed-result" id="installmentPeriodParsed">기간을 선택해주세요</div>
                       </div>
                   </div>
                   
                   <div class="preset-amounts">
                       <div class="preset-title">🎯 빠른 금액 선택</div>
                       <div class="preset-grid">
                           <button class="preset-btn" onclick="setPrincipal(1000000)">100만원</button>
                           <button class="preset-btn" onclick="setPrincipal(3000000)">300만원</button>
                           <button class="preset-btn" onclick="setPrincipal(5000000)">500만원</button>
                           <button class="preset-btn" onclick="setPrincipal(10000000)">1000만원</button>
                           <button class="preset-btn" onclick="setPrincipal(20000000)">2000만원</button>
                           <button class="preset-btn" onclick="setPrincipal(50000000)">5000만원</button>
                       </div>
                   </div>
               </div>
               
               <div class="controls">
                   <button class="btn" onclick="calculateBasicInstallment()">💳 할부 계산</button>
                   <button class="btn btn-secondary" onclick="showBasicExample()">📝 예시</button>
                   <button class="btn btn-danger" onclick="clearBasic()">🗑️ 초기화</button>
               </div>
               
               <div class="result-section" id="basicResult"></div>
           </div>
           
           <!-- 대출 계산 -->
           <div id="loan" class="tab-content">
               <div class="input-section">
                   <div class="input-grid">
                       <div class="input-group">
                           <div class="input-label">
                               <span>💰</span>
                               대출 원금
                           </div>
                           <input type="text" id="loan-principal" placeholder="예: 5000만원, 50000000원..." oninput="smartParseLoan()">
                           <div class="parsed-result" id="loanPrincipalParsed">대출 금액을 입력해주세요</div>
                       </div>
                       
                       <div class="input-group">
                           <div class="input-label">
                               <span>📊</span>
                               연이율 (%)
                           </div>
                           <input type="number" id="loan-rate" placeholder="예: 3.5" step="0.1" oninput="smartParseLoan()">
                           <div class="parsed-result" id="loanRateParsed">이율을 입력해주세요</div>
                       </div>
                       
                       <div class="input-group">
                           <div class="input-label">
                               <span>📅</span>
                               대출 기간
                           </div>
                           <select id="loan-period" onchange="smartParseLoan()">
                               <option value="">기간 선택</option>
                               <option value="12">1년</option>
                               <option value="24">2년</option>
                               <option value="36">3년</option>
                               <option value="60">5년</option>
                               <option value="120">10년</option>
                               <option value="180">15년</option>
                               <option value="240">20년</option>
                               <option value="300">25년</option>
                               <option value="360">30년</option>
                           </select>
                           <div class="parsed-result" id="loanPeriodParsed">기간을 선택해주세요</div>
                       </div>
                       
                       <div class="input-group">
                           <div class="input-label">
                               <span>🏠</span>
                               상환 방식
                           </div>
                           <select id="repayment-type" onchange="smartParseLoan()">
                               <option value="equal">원리금균등상환</option>
                               <option value="principal">원금균등상환</option>
                               <option value="interest">만기일시상환</option>
                           </select>
                           <div class="parsed-result" id="repaymentTypeParsed">원리금균등상환이 선택되었습니다</div>
                       </div>
                   </div>
               </div>
               
               <div class="controls">
                   <button class="btn" onclick="calculateLoan()">🏦 대출 계산</button>
                   <button class="btn btn-secondary" onclick="showLoanExample()">📝 예시</button>
                   <button class="btn btn-danger" onclick="clearLoan()">🗑️ 초기화</button>
               </div>
               
               <div class="result-section" id="loanResult"></div>
           </div>
           
           <!-- 중도상환 -->
           <div id="early" class="tab-content">
               <div class="input-section">
                   <div class="input-grid">
                       <div class="input-group">
                           <div class="input-label">
                               <span>💰</span>
                               현재 잔액
                           </div>
                           <input type="text" id="remaining-balance" placeholder="예: 2000만원, 20000000원..." oninput="smartParseEarly()">
                           <div class="parsed-result" id="remainingBalanceParsed">잔액을 입력해주세요</div>
                       </div>
                       
                       <div class="input-group">
                           <div class="input-label">
                               <span>📊</span>
                               현재 연이율 (%)
                           </div>
                           <input type="number" id="current-rate" placeholder="예: 4.5" step="0.1" oninput="smartParseEarly()">
                           <div class="parsed-result" id="currentRateParsed">이율을 입력해주세요</div>
                       </div>
                       
                       <div class="input-group">
                           <div class="input-label">
                               <span>📅</span>
                               남은 기간 (개월)
                           </div>
                           <input type="number" id="remaining-months" placeholder="예: 24" min="1" oninput="smartParseEarly()">
                           <div class="parsed-result" id="remainingMonthsParsed">남은 기간을 입력해주세요</div>
                       </div>
                       
                       <div class="input-group">
                           <div class="input-label">
                               <span>💳</span>
                               중도상환 금액
                           </div>
                           <input type="text" id="prepayment-amount" placeholder="예: 500만원, 5000000원..." oninput="smartParseEarly()">
                           <div class="parsed-result" id="prepaymentAmountParsed">상환 금액을 입력해주세요</div>
                       </div>
                   </div>
               </div>
               
               <div class="controls">
                   <button class="btn" onclick="calculateEarlyPayment()">💰 중도상환 계산</button>
                   <button class="btn btn-secondary" onclick="showEarlyExample()">📝 예시</button>
                   <button class="btn btn-danger" onclick="clearEarly()">🗑️ 초기화</button>
               </div>
               
               <div class="result-section" id="earlyResult"></div>
           </div>
       </div>
   </div>

   <script>
       let currentTab = 'basic';
       
       class PriceParser {
           constructor() {
               this.koreanUnits = {
                   '천': 1000,
                   '만': 10000,
                   '억': 100000000
               };
           }
           
           parseAmount(input) {
               if (!input) return null;
               
               let cleaned = input.replace(/\s+/g, '');
               
               for (let [unit, multiplier] of Object.entries(this.koreanUnits)) {
                   if (cleaned.includes(unit)) {
                       let parts = cleaned.split(unit);
                       if (parts[0]) {
                           let num = parseFloat(parts[0].replace(/[^0-9.]/g, ''));
                           if (!isNaN(num)) {
                               return num * multiplier;
                           }
                       }
                   }
               }
               
               cleaned = cleaned.replace(/[^0-9.]/g, '');
               let num = parseFloat(cleaned);
               
               return isNaN(num) ? null : num;
           }
       }
       
       const parser = new PriceParser();
       
       function switchTab(tabName) {
           document.querySelectorAll('.tab-button').forEach(btn => {
               btn.classList.remove('active');
           });
           event.target.classList.add('active');
           
           document.querySelectorAll('.tab-content').forEach(content => {
               content.classList.remove('active');
           });
           document.getElementById(tabName).classList.add('active');
           
           currentTab = tabName;
       }
       
       // 기본 할부 계산
       function smartParseBasic() {
           const amount = document.getElementById('principal-amount').value;
           const rate = document.getElementById('interest-rate').value;
           const period = document.getElementById('installment-period').value;
           
           const parsedAmount = parser.parseAmount(amount);
           
           if (parsedAmount) {
               document.getElementById('principalAmountParsed').textContent = `인식됨: ${parsedAmount.toLocaleString()}원`;
           } else {
               document.getElementById('principalAmountParsed').textContent = '금액을 입력해주세요';
           }
           
           if (rate) {
               document.getElementById('interestRateParsed').textContent = `연이율: ${rate}%`;
           } else {
               document.getElementById('interestRateParsed').textContent = '이율을 입력해주세요';
           }
           
           if (period) {
               document.getElementById('installmentPeriodParsed').textContent = `할부 기간: ${period}개월`;
           } else {
               document.getElementById('installmentPeriodParsed').textContent = '기간을 선택해주세요';
           }
       }
       
       function setPrincipal(amount) {
           document.getElementById('principal-amount').value = amount.toLocaleString() + '원';
           smartParseBasic();
       }
       
       function calculateBasicInstallment() {
           const principal = parser.parseAmount(document.getElementById('principal-amount').value);
           const annualRate = parseFloat(document.getElementById('interest-rate').value);
           const months = parseInt(document.getElementById('installment-period').value);
           
           if (!principal || !annualRate || !months) {
               alert('모든 항목을 입력해주세요.');
               return;
           }
           
           const monthlyRate = annualRate / 100 / 12;
           
           // 원리금균등상환 방식으로 계산
           const monthlyPayment = principal * (monthlyRate * Math.pow(1 + monthlyRate, months)) / (Math.pow(1 + monthlyRate, months) - 1);
           const totalPayment = monthlyPayment * months;
           const totalInterest = totalPayment - principal;
           
           // 상환 스케줄 생성
           let balance = principal;
           let schedule = [];
           
           for (let month = 1; month <= months; month++) {
               const interestPayment = balance * monthlyRate;
               const principalPayment = monthlyPayment - interestPayment;
               balance -= principalPayment;
               
               schedule.push({
                   month: month,
                   payment: monthlyPayment,
                   principal: principalPayment,
                   interest: interestPayment,
                   balance: Math.max(0, balance)
               });
           }
           
           const resultHTML = `
               <div class="result-title">💳 할부 계산 결과</div>
               <div class="installment-display">
                   <div class="installment-value">${Math.round(monthlyPayment).toLocaleString()}원</div>
                   <div class="installment-description">월 할부금</div>
               </div>
               <div class="result-grid">
                   <div class="result-item">
                       <div class="result-label">원금</div>
                       <div class="result-value">${principal.toLocaleString()}원</div>
                   </div>
                   <div class="result-item">
                       <div class="result-label">연이율</div>
                       <div class="result-value">${annualRate}%</div>
                   </div>
                   <div class="result-item">
                       <div class="result-label">할부 기간</div>
                       <div class="result-value">${months}개월</div>
                   </div>
                   <div class="result-item">
                       <div class="result-label">월 할부금</div>
                       <div class="result-value">${Math.round(monthlyPayment).toLocaleString()}원</div>
                   </div>
                   <div class="result-item">
                       <div class="result-label">총 상환액</div>
                       <div class="result-value">${Math.round(totalPayment).toLocaleString()}원</div>
                   </div>
                   <div class="result-item">
                       <div class="result-label">총 이자</div>
                       <div class="result-value">${Math.round(totalInterest).toLocaleString()}원</div>
                   </div>
               </div>
               <div class="payment-schedule">
                   <div class="schedule-title">📅 상환 일정표 (처음 12개월)</div>
                   <table class="schedule-table">
                       <thead>
                           <tr>
                               <th>회차</th>
                               <th>납입액</th>
                               <th>원금</th>
                               <th>이자</th>
                               <th>잔액</th>
                           </tr>
                       </thead>
                       <tbody>
                           ${schedule.slice(0, 12).map(item => `
                               <tr>
                                   <td>${item.month}회</td>
                                   <td>${Math.round(item.payment).toLocaleString()}원</td>
                                   <td>${Math.round(item.principal).toLocaleString()}원</td>
                                   <td>${Math.round(item.interest).toLocaleString()}원</td>
                                   <td>${Math.round(item.balance).toLocaleString()}원</td>
                               </tr>
                           `).join('')}
                       </tbody>
                   </table>
               </div>
           `;
           
           document.getElementById('basicResult').innerHTML = resultHTML;
           document.getElementById('basicResult').style.display = 'block';
           document.getElementById('basicResult').scrollIntoView({ behavior: 'smooth' });
       }
       
       function showBasicExample() {
           document.getElementById('principal-amount').value = '1000만원';
           document.getElementById('interest-rate').value = '5.5';
           document.getElementById('installment-period').value = '24';
           smartParseBasic();
       }
       
       function clearBasic() {
           document.getElementById('principal-amount').value = '';
           document.getElementById('interest-rate').value = '';
           document.getElementById('installment-period').value = '';
           smartParseBasic();
           document.getElementById('basicResult').style.display = 'none';
       }
       
       // 대출 계산
       function smartParseLoan() {
           const principal = document.getElementById('loan-principal').value;
           const rate = document.getElementById('loan-rate').value;
           const period = document.getElementById('loan-period').value;
           const type = document.getElementById('repayment-type').value;
           
           const parsedPrincipal = parser.parseAmount(principal);
           
           if (parsedPrincipal) {
               document.getElementById('loanPrincipalParsed').textContent = `인식됨: ${parsedPrincipal.toLocaleString()}원`;
           } else {
               document.getElementById('loanPrincipalParsed').textContent = '대출 금액을 입력해주세요';
           }
           
           if (rate) {
               document.getElementById('loanRateParsed').textContent = `연이율: ${rate}%`;
           } else {
               document.getElementById('loanRateParsed').textContent = '이율을 입력해주세요';
           }
           
           if (period) {
               const years = Math.floor(period / 12);
               const months = period % 12;
               document.getElementById('loanPeriodParsed').textContent = `대출 기간: ${years}년 ${months}개월`;
           } else {
               document.getElementById('loanPeriodParsed').textContent = '기간을 선택해주세요';
           }
           
           const repaymentTypes = {
               'equal': '원리금균등상환이 선택되었습니다',
               'principal': '원금균등상환이 선택되었습니다',
               'interest': '만기일시상환이 선택되었습니다'
           };
           
           document.getElementById('repaymentTypeParsed').textContent = repaymentTypes[type];
       }
       
       function calculateLoan() {
           const principal = parser.parseAmount(document.getElementById('loan-principal').value);
           const annualRate = parseFloat(document.getElementById('loan-rate').value);
           const months = parseInt(document.getElementById('loan-period').value);
           const repaymentType = document.getElementById('repayment-type').value;
           
           if (!principal || !annualRate || !months) {
               alert('모든 항목을 입력해주세요.');
               return;
           }
           
           const monthlyRate = annualRate / 100 / 12;
           let monthlyPayment, totalPayment, totalInterest;
           
           if (repaymentType === 'equal') {
               // 원리금균등상환
               monthlyPayment = principal * (monthlyRate * Math.pow(1 + monthlyRate, months)) / (Math.pow(1 + monthlyRate, months) - 1);
               totalPayment = monthlyPayment * months;
               totalInterest = totalPayment - principal;
           } else if (repaymentType === 'principal') {
               // 원금균등상환
               const principalPayment = principal / months;
               const firstMonthInterest = principal * monthlyRate;
               monthlyPayment = principalPayment + firstMonthInterest;
               totalInterest = (principal * monthlyRate) * (months + 1) / 2;
               totalPayment = principal + totalInterest;
           } else {
               // 만기일시상환
               monthlyPayment = principal * monthlyRate;
               totalInterest = monthlyPayment * months;
               totalPayment = principal + totalInterest;
           }
           
           const resultHTML = `
               <div class="result-title">🏦 대출 계산 결과</div>
               <div class="installment-display">
                   <div class="installment-value">${Math.round(monthlyPayment).toLocaleString()}원</div>
                   <div class="installment-description">${repaymentType === 'equal' ? '월 상환액' : repaymentType === 'principal' ? '첫 달 상환액' : '월 이자'}</div>
               </div>
               <div class="result-grid">
                   <div class="result-item">
                       <div class="result-label">대출 원금</div>
                       <div class="result-value">${principal.toLocaleString()}원</div>
                   </div>
                   <div class="result-item">
                       <div class="result-label">연이율</div>
                       <div class="result-value">${annualRate}%</div>
                   </div>
                   <div class="result-item">
                       <div class="result-label">대출 기간</div>
                       <div class="result-value">${months}개월</div>
                   </div>
                   <div class="result-item">
                       <div class="result-label">상환 방식</div>
                       <div class="result-value" style="font-size: 1rem;">
                           ${repaymentType === 'equal' ? '원리금균등' : repaymentType === 'principal' ? '원금균등' : '만기일시'}
                       </div>
                   </div>
                   <div class="result-item">
                       <div class="result-label">총 상환액</div>
                       <div class="result-value">${Math.round(totalPayment).toLocaleString()}원</div>
                   </div>
                   <div class="result-item">
                       <div class="result-label">총 이자</div>
                       <div class="result-value">${Math.round(totalInterest).toLocaleString()}원</div>
                   </div>
               </div>
           `;
           
           document.getElementById('loanResult').innerHTML = resultHTML;
           document.getElementById('loanResult').style.display = 'block';
           document.getElementById('loanResult').scrollIntoView({ behavior: 'smooth' });
       }
       
       function showLoanExample() {
           document.getElementById('loan-principal').value = '3억원';
           document.getElementById('loan-rate').value = '3.5';
           document.getElementById('loan-period').value = '360';
           document.getElementById('repayment-type').value = 'equal';
           smartParseLoan();
       }
       
       function clearLoan() {
           document.getElementById('loan-principal').value = '';
           document.getElementById('loan-rate').value = '';
           document.getElementById('loan-period').value = '';
           document.getElementById('repayment-type').value = 'equal';
           smartParseLoan();
           document.getElementById('loanResult').style.display = 'none';
       }
       
       // 중도상환 계산
       function smartParseEarly() {
           const balance = document.getElementById('remaining-balance').value;
           const rate = document.getElementById('current-rate').value;
           const months = document.getElementById('remaining-months').value;
           const prepayment = document.getElementById('prepayment-amount').value;
           
           const parsedBalance = parser.parseAmount(balance);
           const parsedPrepayment = parser.parseAmount(prepayment);
           
           if (parsedBalance) {
               document.getElementById('remainingBalanceParsed').textContent = `인식됨: ${parsedBalance.toLocaleString()}원`;
           } else {
               document.getElementById('remainingBalanceParsed').textContent = '잔액을 입력해주세요';
           }
           
           if (rate) {
               document.getElementById('currentRateParsed').textContent = `연이율: ${rate}%`;
           } else {
               document.getElementById('currentRateParsed').textContent = '이율을 입력해주세요';
           }
           
           if (months) {
               document.getElementById('remainingMonthsParsed').textContent = `남은 기간: ${months}개월`;
           } else {
               document.getElementById('remainingMonthsParsed').textContent = '남은 기간을 입력해주세요';
           }
           
           if (parsedPrepayment) {
               document.getElementById('prepaymentAmountParsed').textContent = `인식됨: ${parsedPrepayment.toLocaleString()}원`;
           } else {
               document.getElementById('prepaymentAmountParsed').textContent = '상환 금액을 입력해주세요';
           }
       }
       
       function calculateEarlyPayment() {
           const remainingBalance = parser.parseAmount(document.getElementById('remaining-balance').value);
           const annualRate = parseFloat(document.getElementById('current-rate').value);
           const remainingMonths = parseInt(document.getElementById('remaining-months').value);
           const prepaymentAmount = parser.parseAmount(document.getElementById('prepayment-amount').value);
           
           if (!remainingBalance || !annualRate || !remainingMonths || !prepaymentAmount) {
               alert('모든 항목을 입력해주세요.');
               return;
           }
           
           if (prepaymentAmount > remainingBalance) {
               alert('중도상환 금액이 잔액보다 클 수 없습니다.');
               return;
           }
           
           const monthlyRate = annualRate / 100 / 12;
           
           // 기존 월 상환액 계산
           const originalMonthlyPayment = remainingBalance * (monthlyRate * Math.pow(1 + monthlyRate, remainingMonths)) / (Math.pow(1 + monthlyRate, remainingMonths) - 1);
           
           // 중도상환 후 잔액
           const newBalance = remainingBalance - prepaymentAmount;
           
           // 새로운 월 상환액 계산
           const newMonthlyPayment = newBalance * (monthlyRate * Math.pow(1 + monthlyRate, remainingMonths)) / (Math.pow(1 + monthlyRate, remainingMonths) - 1);
           
           // 이자 절약액 계산
           const originalTotalPayment = originalMonthlyPayment * remainingMonths;
           const newTotalPayment = newMonthlyPayment * remainingMonths + prepaymentAmount;
           const interestSavings = originalTotalPayment - newTotalPayment;
           
           const resultHTML = `
               <div class="result-title">💰 중도상환 계산 결과</div>
               <div class="installment-display">
                   <div class="installment-value">${Math.round(interestSavings).toLocaleString()}원</div>
                   <div class="installment-description">이자 절약액</div>
               </div>
               <div class="result-grid">
                   <div class="result-item">
                       <div class="result-label">현재 잔액</div>
                       <div class="result-value">${remainingBalance.toLocaleString()}원</div>
                   </div>
                   <div class="result-item">
                       <div class="result-label">중도상환액</div>
                       <div class="result-value">${prepaymentAmount.toLocaleString()}원</div>
                   </div>
                   <div class="result-item">
                       <div class="result-label">상환 후 잔액</div>
                       <div class="result-value">${newBalance.toLocaleString()}원</div>
                   </div>
                   <div class="result-item">
                       <div class="result-label">기존 월 상환액</div>
                       <div class="result-value">${Math.round(originalMonthlyPayment).toLocaleString()}원</div>
                   </div>
                   <div class="result-item">
                       <div class="result-label">새 월 상환액</div>
                       <div class="result-value">${Math.round(newMonthlyPayment).toLocaleString()}원</div>
                   </div>
                   <div class="result-item">
                       <div class="result-label">월 상환액 절약</div>
                       <div class="result-value">${Math.round(originalMonthlyPayment - newMonthlyPayment).toLocaleString()}원</div>
                   </div>
                   <div class="result-item">
                       <div class="result-label">총 이자 절약</div>
                       <div class="result-value">${Math.round(interestSavings).toLocaleString()}원</div>
                   </div>
                   <div class="result-item">
                       <div class="result-label">절약 비율</div>
                       <div class="result-value">${((interestSavings / originalTotalPayment) * 100).toFixed(2)}%</div>
                   </div>
               </div>
           `;
           
           document.getElementById('earlyResult').innerHTML = resultHTML;
           document.getElementById('earlyResult').style.display = 'block';
           document.getElementById('earlyResult').scrollIntoView({ behavior: 'smooth' });
       }
       
       function showEarlyExample() {
           document.getElementById('remaining-balance').value = '2000만원';
           document.getElementById('current-rate').value = '4.5';
           document.getElementById('remaining-months').value = '36';
           document.getElementById('prepayment-amount').value = '500만원';
           smartParseEarly();
       }
       
       function clearEarly() {
           document.getElementById('remaining-balance').value = '';
           document.getElementById('current-rate').value = '';
           document.getElementById('remaining-months').value = '';
           document.getElementById('prepayment-amount').value = '';
           smartParseEarly();
           document.getElementById('earlyResult').style.display = 'none';
       }
       
       window.addEventListener('load', function() {
           showBasicExample();
           setTimeout(() => calculateBasicInstallment(), 1500);
       });
   </script>
</body>
</html>
